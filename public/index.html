<!doctype html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Canvas fun</title>
  <link rel="stylesheet" href="/public/style.css" type="text/css"/>
  <script type="text/javascript" src="/public/jquery.js"></script>
  <script type="text/javascript" src="/public/jquery.ws.js"></script>
  <script type="text/javascript" src="/public/client.js"></script>
  <script type="text/javascript">
    var ws //, gad
    $(document).ready(function () {
      /*
      gad = new GadClient(
        document.getElementById('main_viewport'),
        document.getElementById('chat_area')
      );
      gad.start();
      */

      ws = $.ws.conn({
        url : 'ws://localhost:3840',
        hbStr: null,
        onopen : function () {
          $('#chat_send').click(function (e) {
            ws.send($('#chat_input').val());
            $('#chat_input').val('');
          })
          console.log('connected');
        },
        onmessage : function (data) {
          data = JSON.parse(data);
          if (data.counts) {
            for (var x = 0; x < data.counts.length; x++) {
              $('#term' + (x + 1) +'_count').html(data.counts[x])
            }
          }
          if (data.terms) {
            for (var t = 0; t < data.terms.length; t++) {
              $('#term' + (t+1)).html(data.terms[t])
            }
          }
          if (data.message) { $('#chat_output').append('<div>'+data.message+'</div>')}
        },
        onclose : function (event) {
          console.log('disconnected');
        }
      });
    });
  </script>
</head>
<body>

<!-- <div id="game_area">
  <canvas id="main_viewport" width="800" height="500">
    You need a web browser that supports the canvas element.
  </canvas>
</div> -->

<div id="game_area">
  <span id="term1"></span>: <span id="term1_count"></span>
  <span id="term2"></span>: <span id="term2_count"></span>
</div>

<div id="chat_area">
  <input id="chat_input" size="40"/>
  <button id="chat_send">Send</button>
  <div id="chat_output"></div>
</div>

</body>
</html>
